/**
 * @版本: Senro.3.2.js(http://www.passtome.com/js/Senro.3.2.js)
 * @依赖: jquery 1.9.1(http://static.woniu.com/script/jquery/jquery-1.9.1.min.js)
 * @作者: senro(http://senro.cn)
 * @版权: senro.cn(http://www.passtome.com/)
 * @感谢: NightKnight(#)、蒹葭从风(#)、woniu.com(http://www.woniu.com)
 * @简介: Senro.js 是senro根据日常工作的需求开发的经验总结，目的是快速应对各种蜗牛前端开发中需要用到的常用js方法和组件，
 *       可以把这个对象想象成senro本人，它有自己的属性、方法。开发原则是尽量用一句话解决一个问题当然，尽量减少传参，参数按重要
 *       级别从左往右。由于水平有限，难免会有bug，和不完善，还请需要使用的各位，多多包涵，并指出不足，以便完善；
 * @包含: 核心公用方法(core)、常用组件(widget)、常用界面交互方法(UIInteractive)、常用后端交互方法(dataInteractive)、常用检测方法(check)、常用修复方法(fix)、资源加载(load)、常用js模拟html5效果方法(html5)、常用动画方法(animate)
 */
var Senro=function(e){function t(e){senro[e].state=!0,senro[e].action.fire();for(var t=0;t<senro[e].callbacks.length;t++)senro[e].callbacks[t]&&senro[e].callbacks[t](senro[e].objects[t]);return!1}if(arr_requireJs=e||[],senro=this,senro.version=3.2,senro.video={url:"http://static.woniu.com/script/jwplayer/jwplayer.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.swf={url:"http://static.woniu.com/js/swfobject.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.login={url:"http://static.woniu.com/script/widget/passport/login.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.register={url:"http://static.woniu.com/script/widget/passport/passport.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.iePng={url:"http://static.woniu.com/script/iepng/iepng.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.drag={url:"http://static.woniu.com/script/plugin/jquery-ui-drag.min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.mouseWheel={url:"http://static.woniu.com/script/plugin/jquery.mousewheel.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.MSClass={url:"http://static.woniu.com/script/plugin/MSClass.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.animateColors={url:"http://static.woniu.com/script/plugin/jquery.animate-colors-min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.cssSandpaper={url:"http://static.woniu.com/script/plugin/cssSandpaper.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.tweenLite={url:"http://static.woniu.com/script/plugin/greensock-v12-js/TweenLite.min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.tweenMax={url:"http://static.woniu.com/script/plugin/greensock-v12-js/TweenMax.min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.testHtml5={url:"http://static.woniu.com/script/plugin/modernizr.custom.testHtml5.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.preload={url:"http://static.woniu.com/script/plugin/preloadjs-0.3.1.min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.mobile={url:"http://static.woniu.com/script/jquery/jquery.event.touch.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},"string"==typeof arr_requireJs&&(arr_requireJs=[arr_requireJs]),arr_requireJs.length>0)for(var n=0;n<arr_requireJs.length;n++)switch(arr_requireJs[n]){case"video":$.getScript(senro.video.url,function(){t("video")});break;case"swf":$.getScript(senro.swf.url,function(){t("swf")});break;case"login":$.getScript(senro.login.url,function(){t("login")});break;case"register":$.getScript(senro.register.url,function(){t("register")});break;case"iePng":senro.isIE6()&&$.getScript(senro.iePng.url,function(){t("iePng")});break;case"drag":$.getScript(senro.drag.url,function(){t("drag")});break;case"mouseWheel":$.getScript(senro.mouseWheel.url,function(){t("mouseWheel")});break;case"MSClass":$.getScript(senro.MSClass.url,function(){t("MSClass")});break;case"animateColors":$.getScript(senro.animateColors.url,function(){t("animateColors")});break;case"cssSandpaper":$.getScript(senro.cssSandpaper.url,function(){t("cssSandpaper")});break;case"tweenLite":$.getScript(senro.tweenLite.url,function(){t("tweenLite")});break;case"tweenMax":$.getScript(senro.tweenMax.url,function(){t("tweenMax")});break;case"testHtml5":$.getScript(senro.testHtml5.url,function(){t("testHtml5")});break;case"preload":$.getScript(senro.preload.url,function(){t("preload")});break;case"mobile":$.getScript(senro.mobile.url,function(){t("mobile")})}senro.errMsg={video:"请在初始化Senro()时加入'video',例如new Senro('video');如有多个请以数组形式。",swf:"请在初始化Senro()时加入'swf',例如new Senro('swf');如有多个请以数组形式。",login:"请在初始化Senro()时加入'login',例如new Senro('login');如有多个请以数组形式。",register:"请在初始化Senro()时加入'register',例如new Senro('register');如有多个请以数组形式。",iePng:"请在初始化Senro()时加入'iePng',例如new Senro('iePng');如有多个请以数组形式。",drag:"请在初始化Senro()时加入'drag',例如new Senro('drag');如有多个请以数组形式。",mouseWheel:"请在初始化Senro()时加入'mouseWheel',例如new Senro('mouseWheel');如有多个请以数组形式。",MSClass:"请在初始化Senro()时加入'MSClass',例如new Senro('MSClass');如有多个请以数组形式。",animateColors:"请在初始化Senro()时加入'animateColors',例如new Senro('animateColors');如有多个请以数组形式。",cssSandpaper:"请在初始化Senro()时加入'cssSandpaper',例如new Senro('cssSandpaper');如有多个请以数组形式。",tweenLite:"请在初始化Senro()时加入'tweenLite',例如new Senro('tweenLite');如有多个请以数组形式。",tweenMax:"请在初始化Senro()时加入'tweenMax',例如new Senro('tweenMax');如有多个请以数组形式。",testHtml5:"请在初始化Senro()时加入'testHtml5',例如new Senro('testHtml5');如有多个请以数组形式。",preload:"请在初始化Senro()时加入'preload',例如new Senro('preload');如有多个请以数组形式。",mobile:"请在初始化Senro()时加入'mobile',例如new Senro('mobile');如有多个请以数组形式。"},jQuery.extend({visibleHidden:function(e){return e.css({visibility:"hidden"}),!1},visibleShow:function(e){return e.css({visibility:"visible"}),!1}})};Senro.prototype={constructor:Senro,sliderLR:function(e,t,n,r,s,i,o,a){function l(e,t,n){var r=e.parent(),s=r.width(),i=(t/n).toFixed(1);0==i?e.css("left",s*i+"px"):e.animate({left:s*i-e.width()+"px"},100)}function c(e,t){var n=u(e),r=n.eq(1).outerWidth(!0),s=-t*r;return e.animate({left:s+"px"},200),!1}function u(e){var t;return e.find("a").length>0?t=e.find("a").siblings():e.find("div").length>0?t=e.find("div").siblings():e.find("li").length>0?t=e.find("li").siblings():e.find("img").length>0&&(t=e.find("img").siblings()),t}function p(e,t){var n=u(e),r=n.length,s=n.outerWidth(!0),i=((e.parent().width()/2).toFixed(1)-5,J.position().left,J.outerWidth(!0)/2,parseInt(n.eq(t).css("margin-left"))),o=r*s-e.parent().width();return T&&e.css("left",q),L>t?(J.css({left:n.eq(t).position().left+i+"px"},200),T=!1):t>=L&&-e.position().left<o-s||-e.position().left>0&&H>t&&W>t?(W=t,e.animate({left:-s*(t-L)+"px"},200),J.animate({left:n.eq(t).position().left+i+"px"},200),T=!1):(J.css({left:n.eq(t).position().left+i+"px"},200),H=t,T=!1),!1}var g={list:$,btn_l:$,btn_r:$,thumbList:$,thumbBtn_l:null,thumbBtn_r:null,sliderCube:null,current:"thumb_current"};senro.parseArgus(arguments,g);var e=g.list,t=g.btn_l,n=g.btn_r,r=g.thumbList,s=g.thumbBtn_l,i=g.thumbBtn_r,o=g.sliderCube,a=g.current,d=t,f=n,b=e,h=s||null,m=i||null,w=r||null,o=o||null,S=a||"thumb_current",k=u(b),v=u(w);if(null!=k){(e.find("img").attr("lazy")||r.find("img").attr("lazy"))&&e.add(r).find("img").each(function(t){e.add(r).find("img").eq(t).attr("src",e.add(r).find("img").eq(t).attr("lazy"))});var j=k.length-1,C=0;d.add(h).click(function(){return b.is(":animated")?!1:0>=C?(C=0,!1):(C--,c(b,C),w&&(p(w,C),o&&l(o,C,j)),!1)}),f.add(m).click(function(){return b.is(":animated")?!1:C>=j?(C=j,!1):(C++,c(b,C),w&&(p(w,C),o&&l(o,C,j)),!1)})}else senro.console("sliderLR没有检测到需要轮播的物体！");if(null!=v&&v.length>=2){var q,x=(v.length,v.eq(1).outerWidth(!0)),M=v.eq(1).outerWidth(),y=v.eq(1).outerHeight(),_=parseInt(v.eq(0).css("margin-left")),L=(w.parent().width()/2/x).toFixed(0)-1,W=0,H=0,T=!1,J=$('<div class="'+S+'"></div>');w.append(J),w.css("width",v.length*x);var I=parseInt(J.css("borderLeftWidth"));J.css({width:M-2*I+"px",height:y-2*I+"px",left:_+"px",top:v.eq(0).position().top+"px"}),v.click(function(){var e=v.index(this),t=parseInt(v.eq(e).css("margin-left"));return e>j&&(e-=(j+1)*(e%(j+1))),C=e,c(b,C),o&&l(o,C,j),J.animate({left:v.eq(e).position().left+t+"px"},100),!1})}else senro.console("sliderLR缩略图需要至少两个轮播的物体！");o&&senro.checkRequire("drag",function(){var e=w.parent(),t=e.width(),n=w.width();o.css("left","0px"),n>t&&o.draggable({containment:"parent",start:function(){q=w.position().left},drag:function(){var e=o.index(this),r=o.eq(e),s=r.parent(),i=r.position().left/(s.width()-r.width());if(w){var a=(n-t)*i;w.css({left:-a+"px"})}},stop:function(){T=!0}})})},addSwf:function(e,t,n,r,s){var i={id:"",file:"",width:null,height:null,callback:null};senro.parseArgus(arguments,i);var e=i.id,t=i.file,n=i.width,r=i.height,s=i.callback,o=$("#"+e).parent(),a=n||o.width(),l=r||o.height();return senro.checkRequire("swf",function(){senro.swf.objects.push(addSWF(t,e,a,l)),senro.swf.callbacks.push(s)}),!1},getCurrentTime:function(e){function t(e){var e=String(e);return 1==e.length?"0"+e:e}$.getJSON("http://gwpassport2.woniu.com/v2/islogin?jsoncallback=?",function(n){var r=String(n.server_time),s=new Date(1e3*parseInt(r.split(".")[0])),i={date:s.getFullYear()+"-"+t(s.getMonth()+1)+"-"+t(s.getDate()),fullDate:s.getFullYear()+"-"+t(s.getMonth()+1)+"-"+t(s.getDate())+" "+t(s.getHours())+":"+t(s.getMinutes())+":"+t(s.getSeconds()),year:s.getFullYear(),month:t(s.getMonth()+1),day:t(s.getDate()),hour:t(s.getHours()),minutes:t(s.getMinutes()),seconds:t(s.getSeconds())};e&&e(i)})},isTimeOverdue:function(e,t,n){function r(e){function t(e){return/0[0-9]/g.test(e)?e.split("0")[1]:e}if(/\-/g.test(e)){var n=e.replace(/ /g,"T").replace(/\-/g,"/"),r=n.split("T")[0].split("/")[0],s=t(n.split("T")[0].split("/")[1]),i=t(n.split("T")[0].split("/")[2]),o=t(n.split("T")[1].split(":")[0]),a=t(n.split("T")[1].split(":")[1]),l=t(n.split("T")[1].split(":")[2]);return new Date(r,s,i,o,a,l)}return/\//g.test(e)?Date.parse(e):e}function s(e){var t=parseInt(e),n=Math.floor(t/1e3/60/60/24),r=Math.floor(t/1e3/60/60%24),s=Math.floor(t/1e3/60%60),i=Math.floor(t/1e3%60);return{day:n,hour:r,min:s,sec:i}}var i=r(t)-r(e);if(!n)return i>0?!1:!0;setInterval(function(){i>0?i-=1e3:i=0,n&&n(s(i))},1e3);return!1},checkRequire:function(e,t){for(var n=!1,r=0;r<arr_requireJs.length;r++)if(arr_requireJs[r]==e){n=!0;break}if(n)if(senro[e].state){t();for(var s=0;s<senro[e].callbacks.length;s++)senro[e].callbacks[s]&&senro[e].callbacks[s](senro[e].objects[s])}else senro[e].action.add(t);else alert(senro.errMsg[e]);return!1},parseArgus:function(e,t){function n(e){return e instanceof jQuery?"$":"object"==typeof e?"object":!1}var r=0;for(var s in t)t[s]="object"==n(e[0])?e[0][s]?e[0][s]:t[s]:e[r]?e[r]:t[s],r++},console:function(e){!function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],r=n.length,s=window.console=window.console||{};r--;)e=n[r],s[e]||(s[e]=t)}(),console&&console.log(e)}};