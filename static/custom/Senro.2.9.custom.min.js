/**
 * @版本: Senro.2.9.js(http://www.passtome.com/js/Senro.2.9.js)
 * @依赖: jquery 1.9.1(http://static.woniu.com/script/jquery/jquery-1.9.1.min.js)
 * @作者: senro(http://senro.cn)
 * @版权: senro.cn(http://www.passtome.com/)
 * @感谢: NightKnight(#)、蒹葭从风(#)、woniu.com(http://www.woniu.com)
 * @简介: Senro.js 是senro根据日常工作的需求开发的经验总结，目的是快速应对各种蜗牛前端开发中需要用到的常用js方法和组件，
 *       可以把这个对象想象成senro本人，它有自己的属性、方法。开发原则是尽量用一句话解决一个问题当然，尽量减少传参，参数按重要
 *       级别从左往右。由于水平有限，难免会有bug，和不完善，还请需要使用的各位，多多包涵，并指出不足，以便完善；
 * @包含: 核心公用方法(core)、常用组件(widget)、常用界面交互方法(UIInteractive)、常用后端交互方法(dataInteractive)、常用检测方法(check)、常用修复方法(fix)、资源加载(load)、常用js模拟html5效果方法(html5)、常用动画方法(animate)
 */
var Senro=function(e){function t(e){senro[e].state=!0,senro[e].action.fire();for(var t=0;t<senro[e].callbacks.length;t++)senro[e].callbacks[t]&&senro[e].callbacks[t](senro[e].objects[t]);return!1}if(arr_requireJs=e||[],senro=this,senro.video={url:"http://static.woniu.com/script/jwplayer/jwplayer.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.swf={url:"http://static.woniu.com/js/swfobject.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.login={url:"http://static.woniu.com/script/widget/passport/login.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.iePng={url:"http://static.woniu.com/script/iepng/iepng.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.drag={url:"http://static.woniu.com/script/plugin/jquery-ui-drag.min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.mouseWheel={url:"http://static.woniu.com/script/plugin/jquery.mousewheel.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.MSClass={url:"http://static.woniu.com/script/plugin/MSClass.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.animateColors={url:"http://static.woniu.com/script/plugin/jquery.animate-colors-min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.cssSandpaper={url:"http://static.woniu.com/script/plugin/cssSandpaper.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.tweenLite={url:"http://static.woniu.com/script/plugin/greensock-v12-js/TweenLite.min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.tweenMax={url:"http://static.woniu.com/script/plugin/greensock-v12-js/TweenMax.min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.testHtml5={url:"http://static.woniu.com/script/plugin/modernizr.custom.testHtml5.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.preload={url:"http://static.woniu.com/script/plugin/preloadjs-0.3.1.min.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},senro.mobile={url:"http://static.woniu.com/script/jquery/jquery.event.touch.js",state:!1,objects:[],action:$.Callbacks(),callbacks:[]},"string"==typeof arr_requireJs&&(arr_requireJs=[arr_requireJs]),arr_requireJs.length>0)for(var n=0;n<arr_requireJs.length;n++)switch(arr_requireJs[n]){case"video":$.getScript(senro.video.url,function(){t("video")});break;case"swf":$.getScript(senro.swf.url,function(){t("swf")});break;case"login":$.getScript(senro.login.url,function(){t("login")});break;case"iePng":senro.isIE6()&&$.getScript(senro.iePng.url,function(){t("iePng")});break;case"drag":$.getScript(senro.drag.url,function(){t("drag")});break;case"mouseWheel":$.getScript(senro.mouseWheel.url,function(){t("mouseWheel")});break;case"MSClass":$.getScript(senro.MSClass.url,function(){t("MSClass")});break;case"animateColors":$.getScript(senro.animateColors.url,function(){t("animateColors")});break;case"cssSandpaper":$.getScript(senro.cssSandpaper.url,function(){t("cssSandpaper")});break;case"tweenLite":$.getScript(senro.tweenLite.url,function(){t("tweenLite")});break;case"tweenMax":$.getScript(senro.tweenMax.url,function(){t("tweenMax")});break;case"testHtml5":$.getScript(senro.testHtml5.url,function(){t("testHtml5")});break;case"preload":$.getScript(senro.preload.url,function(){t("preload")});break;case"mobile":$.getScript(senro.mobile.url,function(){t("mobile")})}senro.errMsg={video:"请在初始化Senro()时加入'video',例如new Senro('video');如有多个请以数组形式。",swf:"请在初始化Senro()时加入'swf',例如new Senro('swf');如有多个请以数组形式。",login:"请在初始化Senro()时加入'login',例如new Senro('login');如有多个请以数组形式。",iePng:"请在初始化Senro()时加入'iePng',例如new Senro('iePng');如有多个请以数组形式。",drag:"请在初始化Senro()时加入'drag',例如new Senro('drag');如有多个请以数组形式。",mouseWheel:"请在初始化Senro()时加入'mouseWheel',例如new Senro('mouseWheel');如有多个请以数组形式。",MSClass:"请在初始化Senro()时加入'MSClass',例如new Senro('MSClass');如有多个请以数组形式。",animateColors:"请在初始化Senro()时加入'animateColors',例如new Senro('animateColors');如有多个请以数组形式。",cssSandpaper:"请在初始化Senro()时加入'cssSandpaper',例如new Senro('cssSandpaper');如有多个请以数组形式。",tweenLite:"请在初始化Senro()时加入'tweenLite',例如new Senro('tweenLite');如有多个请以数组形式。",tweenMax:"请在初始化Senro()时加入'tweenMax',例如new Senro('tweenMax');如有多个请以数组形式。",testHtml5:"请在初始化Senro()时加入'testHtml5',例如new Senro('testHtml5');如有多个请以数组形式。",preload:"请在初始化Senro()时加入'preload',例如new Senro('preload');如有多个请以数组形式。",mobile:"请在初始化Senro()时加入'mobile',例如new Senro('mobile');如有多个请以数组形式。"},jQuery.extend({visibleHidden:function(e){return e.css({visibility:"hidden"}),!1},visibleShow:function(e){return e.css({visibility:"visible"}),!1}})};Senro.prototype={constructor:Senro,sliderLR:function(e,t,n,i,s,r,a,o){function l(e,t,n){var i=e.parent(),s=i.width(),r=(t/n).toFixed(1);0==r?e.css("left",s*r+"px"):e.animate({left:s*r-e.width()+"px"},100)}function c(e,t){var n=u(e),i=n.eq(1).outerWidth(!0),s=-t*i;return e.animate({left:s+"px"},200),!1}function u(e){var t;return e.find("a").length>0?t=e.find("a").siblings():e.find("div").length>0?t=e.find("div").siblings():e.find("li").length>0?t=e.find("li").siblings():e.find("img").length>0&&(t=e.find("img").siblings()),t}function p(e,t){var n=u(e),i=n.length,s=n.outerWidth(!0),r=((e.parent().width()/2).toFixed(1)-5,I.position().left,I.outerWidth(!0)/2,parseInt(n.eq(t).css("margin-left"))),a=i*s-e.parent().width();return _&&e.css("left",q),y>t?(I.css({left:n.eq(t).position().left+r+"px"},200),_=!1):t>=y&&-e.position().left<a-s||-e.position().left>0&&H>t&&L>t?(L=t,e.animate({left:-s*(t-y)+"px"},200),I.animate({left:n.eq(t).position().left+r+"px"},200),_=!1):(I.css({left:n.eq(t).position().left+r+"px"},200),H=t,_=!1),!1}var d=t,f=n,g=e,h=s||null,m=r||null,b=i||null,a=a||null,w=o||"thumb_current";(e.find("img").attr("lazy")||i.find("img").attr("lazy"))&&e.add(i).find("img").each(function(t){e.add(i).find("img").eq(t).attr("src",e.add(i).find("img").eq(t).attr("lazy"))});var S=u(g),k=S.length-1,v=0;if(d.add(h).click(function(){return g.is(":animated")?!1:0>=v?(v=0,!1):(v--,c(g,v),b&&(p(b,v),a&&l(a,v,k)),!1)}),f.add(m).click(function(){return g.is(":animated")?!1:v>=k?(v=k,!1):(v++,c(g,v),b&&(p(b,v),a&&l(a,v,k)),!1)}),b){var q,x=u(b),j=(x.length,x.eq(1).outerWidth(!0)),C=x.eq(1).outerWidth(),W=x.eq(1).outerHeight(),M=parseInt(x.eq(0).css("margin-left")),y=(b.parent().width()/2/j).toFixed(0)-1,L=0,H=0,_=!1,I=$('<div class="'+w+'"></div>');b.append(I),b.css("width",x.length*j);var J=parseInt(I.css("borderLeftWidth"));I.css({width:C-2*J+"px",height:W-2*J+"px",left:M+"px",top:x.eq(0).position().top+"px"}),x.click(function(){var e=x.index(this),t=parseInt(x.eq(e).css("margin-left"));return e>k&&(e-=(k+1)*(e%(k+1))),v=e,c(g,v),a&&l(a,v,k),I.animate({left:x.eq(e).position().left+t+"px"},100),!1})}a&&senro.checkRequire("drag",function(){var e=b.parent(),t=e.width(),n=b.width();a.css("left","0px"),n>t&&a.draggable({containment:"parent",start:function(){q=b.position().left},drag:function(){var e=a.index(this),i=a.eq(e),s=i.parent(),r=i.position().left/(s.width()-i.width());if(b){var o=(n-t)*r;b.css({left:-o+"px"})}},stop:function(){_=!0}})})},sliderLR:function(e,t,n,i,s,r,a,o){function l(e,t,n){var i=e.parent(),s=i.width(),r=(t/n).toFixed(1);0==r?e.css("left",s*r+"px"):e.animate({left:s*r-e.width()+"px"},100)}function c(e,t){var n=u(e),i=n.eq(1).outerWidth(!0),s=-t*i;return e.animate({left:s+"px"},200),!1}function u(e){var t;return e.find("a").length>0?t=e.find("a").siblings():e.find("div").length>0?t=e.find("div").siblings():e.find("li").length>0?t=e.find("li").siblings():e.find("img").length>0&&(t=e.find("img").siblings()),t}function p(e,t){var n=u(e),i=n.length,s=n.outerWidth(!0),r=((e.parent().width()/2).toFixed(1)-5,I.position().left,I.outerWidth(!0)/2,parseInt(n.eq(t).css("margin-left"))),a=i*s-e.parent().width();return _&&e.css("left",q),y>t?(I.css({left:n.eq(t).position().left+r+"px"},200),_=!1):t>=y&&-e.position().left<a-s||-e.position().left>0&&H>t&&L>t?(L=t,e.animate({left:-s*(t-y)+"px"},200),I.animate({left:n.eq(t).position().left+r+"px"},200),_=!1):(I.css({left:n.eq(t).position().left+r+"px"},200),H=t,_=!1),!1}var d=t,f=n,g=e,h=s||null,m=r||null,b=i||null,a=a||null,w=o||"thumb_current";(e.find("img").attr("lazy")||i.find("img").attr("lazy"))&&e.add(i).find("img").each(function(t){e.add(i).find("img").eq(t).attr("src",e.add(i).find("img").eq(t).attr("lazy"))});var S=u(g),k=S.length-1,v=0;if(d.add(h).click(function(){return g.is(":animated")?!1:0>=v?(v=0,!1):(v--,c(g,v),b&&(p(b,v),a&&l(a,v,k)),!1)}),f.add(m).click(function(){return g.is(":animated")?!1:v>=k?(v=k,!1):(v++,c(g,v),b&&(p(b,v),a&&l(a,v,k)),!1)}),b){var q,x=u(b),j=(x.length,x.eq(1).outerWidth(!0)),C=x.eq(1).outerWidth(),W=x.eq(1).outerHeight(),M=parseInt(x.eq(0).css("margin-left")),y=(b.parent().width()/2/j).toFixed(0)-1,L=0,H=0,_=!1,I=$('<div class="'+w+'"></div>');b.append(I),b.css("width",x.length*j);var J=parseInt(I.css("borderLeftWidth"));I.css({width:C-2*J+"px",height:W-2*J+"px",left:M+"px",top:x.eq(0).position().top+"px"}),x.click(function(){var e=x.index(this),t=parseInt(x.eq(e).css("margin-left"));return e>k&&(e-=(k+1)*(e%(k+1))),v=e,c(g,v),a&&l(a,v,k),I.animate({left:x.eq(e).position().left+t+"px"},100),!1})}a&&senro.checkRequire("drag",function(){var e=b.parent(),t=e.width(),n=b.width();a.css("left","0px"),n>t&&a.draggable({containment:"parent",start:function(){q=b.position().left},drag:function(){var e=a.index(this),i=a.eq(e),s=i.parent(),r=i.position().left/(s.width()-i.width());if(b){var o=(n-t)*r;b.css({left:-o+"px"})}},stop:function(){_=!0}})})},initLogin:function(e,t,n){return senro.checkRequire("login",function(){var i=$(e),s=$(e).find("input");i.attr("method","post"),i.attr("action","http://gwpassport.woniu.com/v2/login"),s.each(function(e){var t=s.eq(e);0==e?(t.hasClass("inputDefault")||t.addClass("inputDefault"),"username"!=t.attr("name")&&t.attr("name","username")):2==e?(t.hasClass("inputDefault")||t.addClass("inputDefault"),"password"!=t.attr("name")&&t.attr("name","password")):(1==e||3==e)&&(t.hasClass("msgContainer")||t.addClass("msgContainer"))});new Login({formId:e,elements:{scope:t,input:{node:".inputDefault",write:".inputWrite",done:".inputComplete"},message:{node:".msgContainer",hover:".msgHover",error:".msgError"}},success:function(e){n&&n(e)},handleMessage:function(e){alert(e)}})}),!1},checkRequire:function(e,t){for(var n=!1,i=0;i<arr_requireJs.length;i++)if(arr_requireJs[i]==e){n=!0;break}if(n)if(senro[e].state){t();for(var s=0;s<senro[e].callbacks.length;s++)senro[e].callbacks[s]&&senro[e].callbacks[s](senro[e].objects[s])}else senro[e].action.add(t);else alert(senro.errMsg[e]);return!1}};